{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///D:/BEDegree/5th-Sem/CC/PetAdopt/lib/config/db.js"],"sourcesContent":["import mongoose from 'mongoose';\r\n\r\nconst MONGODB_URI = process.env.MONGODB_URI;\r\n\r\nif (!MONGODB_URI) {\r\n  throw new Error('Please define the MONGODB_URI environment variable');\r\n}\r\n\r\n/**\r\n * Global is used here to maintain a cached connection across hot reloads\r\n * in development. This prevents connections growing exponentially\r\n * during API Route usage.\r\n */\r\nlet cached = global.mongoose;\r\n\r\nif (!cached) {\r\n  cached = global.mongoose = { conn: null, promise: null };\r\n}\r\n\r\nasync function connectDB() {\r\n  if (cached.conn) {\r\n    return cached.conn;\r\n  }\r\n\r\n  if (!cached.promise) {\r\n    const opts = {\r\n      bufferCommands: false,\r\n      maxPoolSize: 5, // Maintain up to 5 socket connections\r\n      serverSelectionTimeoutMS: 5000, // Keep trying to send operations for 5 seconds\r\n      socketTimeoutMS: 45000, // Close sockets after 45 seconds of inactivity\r\n      family: 4, // Use IPv4, skip trying IPv6\r\n    };\r\n\r\n    cached.promise = mongoose.connect(MONGODB_URI, opts).then((mongoose) => {\r\n      console.log('âœ… MongoDB Connected');\r\n      return mongoose;\r\n    });\r\n  }\r\n\r\n  try {\r\n    cached.conn = await cached.promise;\r\n  } catch (e) {\r\n    cached.promise = null;\r\n    throw e;\r\n  }\r\n\r\n  return cached.conn;\r\n}\r\n\r\nexport default connectDB;"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW;AAE3C,IAAI,CAAC,aAAa;IAChB,MAAM,IAAI,MAAM;AAClB;AAEA;;;;CAIC,GACD,IAAI,SAAS,yDAAO,QAAQ;AAE5B,IAAI,CAAC,QAAQ;IACX,SAAS,yDAAO,QAAQ,GAAG;QAAE,MAAM;QAAM,SAAS;IAAK;AACzD;AAEA,eAAe;IACb,IAAI,OAAO,IAAI,EAAE;QACf,OAAO,OAAO,IAAI;IACpB;IAEA,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,MAAM,OAAO;YACX,gBAAgB;YAChB,aAAa;YACb,0BAA0B;YAC1B,iBAAiB;YACjB,QAAQ;QACV;QAEA,OAAO,OAAO,GAAG,oHAAQ,CAAC,OAAO,CAAC,aAAa,MAAM,IAAI,CAAC,CAAC;YACzD,QAAQ,GAAG,CAAC;YACZ,OAAO;QACT;IACF;IAEA,IAAI;QACF,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IACpC,EAAE,OAAO,GAAG;QACV,OAAO,OAAO,GAAG;QACjB,MAAM;IACR;IAEA,OAAO,OAAO,IAAI;AACpB;uCAEe"}},
    {"offset": {"line": 103, "column": 0}, "map": {"version":3,"sources":["file:///D:/BEDegree/5th-Sem/CC/PetAdopt/lib/models/Pet.js"],"sourcesContent":["import mongoose from 'mongoose';\r\n\r\nconst petSchema = new mongoose.Schema({\r\n  name: {\r\n    type: String,\r\n    required: [true, 'Please provide a pet name'],\r\n    trim: true\r\n  },\r\n  type: {\r\n    type: String,\r\n    required: [true, 'Please specify pet type'],\r\n    enum: ['Dog', 'Cat', 'Bird', 'Rabbit', 'Other']\r\n  },\r\n  breed: {\r\n    type: String,\r\n    required: [true, 'Please provide breed information'],\r\n    trim: true\r\n  },\r\n  ageYears: {\r\n    type: Number,\r\n    required: true,\r\n    min: 0\r\n  },\r\n  ageMonths: {\r\n    type: Number,\r\n    required: true,\r\n    min: 0,\r\n    max: 11\r\n  },\r\n  gender: {\r\n    type: String,\r\n    required: true,\r\n    enum: ['Male', 'Female']\r\n  },\r\n  size: {\r\n    type: String,\r\n    required: true,\r\n    enum: ['Small', 'Medium', 'Large']\r\n  },\r\n  temperament: [{\r\n    type: String\r\n  }],\r\n  vaccinated: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  sterilized: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  description: {\r\n    type: String,\r\n    required: [true, 'Please provide a description'],\r\n    maxlength: [1000, 'Description cannot exceed 1000 characters']\r\n  },\r\n  adoptionFee: {\r\n    type: Number,\r\n    required: true,\r\n    min: 0\r\n  },\r\n  images: [{\r\n    type: String\r\n  }],\r\n  medicalRecords: [{\r\n    type: String\r\n  }],\r\n  shelterId: {\r\n    type: mongoose.Schema.Types.ObjectId,\r\n    ref: 'Shelter'\r\n  },\r\n  status: {\r\n    type: String,\r\n    enum: ['available', 'adopted', 'pending'],\r\n    default: 'available'\r\n  },\r\n  createdAt: {\r\n    type: Date,\r\n    default: Date.now\r\n  }\r\n});\r\n\r\nconst Pet = mongoose.model('Pet', petSchema);\r\nexport default Pet;"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,YAAY,IAAI,oHAAQ,CAAC,MAAM,CAAC;IACpC,MAAM;QACJ,MAAM;QACN,UAAU;YAAC;YAAM;SAA4B;QAC7C,MAAM;IACR;IACA,MAAM;QACJ,MAAM;QACN,UAAU;YAAC;YAAM;SAA0B;QAC3C,MAAM;YAAC;YAAO;YAAO;YAAQ;YAAU;SAAQ;IACjD;IACA,OAAO;QACL,MAAM;QACN,UAAU;YAAC;YAAM;SAAmC;QACpD,MAAM;IACR;IACA,UAAU;QACR,MAAM;QACN,UAAU;QACV,KAAK;IACP;IACA,WAAW;QACT,MAAM;QACN,UAAU;QACV,KAAK;QACL,KAAK;IACP;IACA,QAAQ;QACN,MAAM;QACN,UAAU;QACV,MAAM;YAAC;YAAQ;SAAS;IAC1B;IACA,MAAM;QACJ,MAAM;QACN,UAAU;QACV,MAAM;YAAC;YAAS;YAAU;SAAQ;IACpC;IACA,aAAa;QAAC;YACZ,MAAM;QACR;KAAE;IACF,YAAY;QACV,MAAM;QACN,SAAS;IACX;IACA,YAAY;QACV,MAAM;QACN,SAAS;IACX;IACA,aAAa;QACX,MAAM;QACN,UAAU;YAAC;YAAM;SAA+B;QAChD,WAAW;YAAC;YAAM;SAA4C;IAChE;IACA,aAAa;QACX,MAAM;QACN,UAAU;QACV,KAAK;IACP;IACA,QAAQ;QAAC;YACP,MAAM;QACR;KAAE;IACF,gBAAgB;QAAC;YACf,MAAM;QACR;KAAE;IACF,WAAW;QACT,MAAM,oHAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ;QACpC,KAAK;IACP;IACA,QAAQ;QACN,MAAM;QACN,MAAM;YAAC;YAAa;YAAW;SAAU;QACzC,SAAS;IACX;IACA,WAAW;QACT,MAAM;QACN,SAAS,KAAK,GAAG;IACnB;AACF;AAEA,MAAM,MAAM,oHAAQ,CAAC,KAAK,CAAC,OAAO;uCACnB"}},
    {"offset": {"line": 255, "column": 0}, "map": {"version":3,"sources":["file:///D:/BEDegree/5th-Sem/CC/PetAdopt/lib/models/User.js"],"sourcesContent":["import mongoose from 'mongoose';\r\nimport bcrypt from 'bcryptjs';\r\n\r\nconst userSchema = new mongoose.Schema({\r\n  name: {\r\n    type: String,\r\n    required: [true, 'Please provide a name'],\r\n    trim: true,\r\n    maxlength: [50, 'Name cannot exceed 50 characters']\r\n  },\r\n  email: {\r\n    type: String,\r\n    required: [true, 'Please provide an email'],\r\n    unique: true,\r\n    lowercase: true,\r\n    match: [/^\\S+@\\S+\\.\\S+$/, 'Please provide a valid email']\r\n  },\r\n  phone: {\r\n    type: String,\r\n    required: [true, 'Please provide a phone number'],\r\n    match: [/^[0-9]{10}$/, 'Please provide a valid 10-digit phone number']\r\n  },\r\n  password: {\r\n    type: String,\r\n    required: [true, 'Please provide a password'],\r\n    minlength: [6, 'Password must be at least 6 characters'],\r\n    select: false\r\n  },\r\n  role: {\r\n    type: String,\r\n    enum: ['user', 'admin'],\r\n    default: 'user'\r\n  },\r\n  location: {\r\n    city: { type: String, default: '' },\r\n    state: { type: String, default: '' }\r\n  },\r\n  avatar: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  favorites: [{\r\n    type: mongoose.Schema.Types.ObjectId,\r\n    ref: 'Pet'\r\n  }],\r\n  createdAt: {\r\n    type: Date,\r\n    default: Date.now\r\n  }\r\n});\r\n\r\n// Hash password before saving\r\nuserSchema.pre('save', async function(next) {\r\n  if (!this.isModified('password')) {\r\n    return next();\r\n  }\r\n  const salt = await bcrypt.genSalt(10);\r\n  this.password = await bcrypt.hash(this.password, salt);\r\n  next();\r\n});\r\n\r\n// Compare password method\r\nuserSchema.methods.comparePassword = async function(enteredPassword) {\r\n  return await bcrypt.compare(enteredPassword, this.password);\r\n};\r\n\r\nconst User = mongoose.model('User', userSchema);\r\nexport default User;"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,aAAa,IAAI,oHAAQ,CAAC,MAAM,CAAC;IACrC,MAAM;QACJ,MAAM;QACN,UAAU;YAAC;YAAM;SAAwB;QACzC,MAAM;QACN,WAAW;YAAC;YAAI;SAAmC;IACrD;IACA,OAAO;QACL,MAAM;QACN,UAAU;YAAC;YAAM;SAA0B;QAC3C,QAAQ;QACR,WAAW;QACX,OAAO;YAAC;YAAkB;SAA+B;IAC3D;IACA,OAAO;QACL,MAAM;QACN,UAAU;YAAC;YAAM;SAAgC;QACjD,OAAO;YAAC;YAAe;SAA+C;IACxE;IACA,UAAU;QACR,MAAM;QACN,UAAU;YAAC;YAAM;SAA4B;QAC7C,WAAW;YAAC;YAAG;SAAyC;QACxD,QAAQ;IACV;IACA,MAAM;QACJ,MAAM;QACN,MAAM;YAAC;YAAQ;SAAQ;QACvB,SAAS;IACX;IACA,UAAU;QACR,MAAM;YAAE,MAAM;YAAQ,SAAS;QAAG;QAClC,OAAO;YAAE,MAAM;YAAQ,SAAS;QAAG;IACrC;IACA,QAAQ;QACN,MAAM;QACN,SAAS;IACX;IACA,WAAW;QAAC;YACV,MAAM,oHAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ;YACpC,KAAK;QACP;KAAE;IACF,WAAW;QACT,MAAM;QACN,SAAS,KAAK,GAAG;IACnB;AACF;AAEA,8BAA8B;AAC9B,WAAW,GAAG,CAAC,QAAQ,eAAe,IAAI;IACxC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,aAAa;QAChC,OAAO;IACT;IACA,MAAM,OAAO,MAAM,mMAAM,CAAC,OAAO,CAAC;IAClC,IAAI,CAAC,QAAQ,GAAG,MAAM,mMAAM,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;IACjD;AACF;AAEA,0BAA0B;AAC1B,WAAW,OAAO,CAAC,eAAe,GAAG,eAAe,eAAe;IACjE,OAAO,MAAM,mMAAM,CAAC,OAAO,CAAC,iBAAiB,IAAI,CAAC,QAAQ;AAC5D;AAEA,MAAM,OAAO,oHAAQ,CAAC,KAAK,CAAC,QAAQ;uCACrB"}},
    {"offset": {"line": 364, "column": 0}, "map": {"version":3,"sources":["file:///D:/BEDegree/5th-Sem/CC/PetAdopt/lib/middleware/auth.js"],"sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport User from '../models/User.js';\r\n\r\nexport const authRequired = async (req) => {\r\n  let token;\r\n\r\n  // Check for token in Authorization header\r\n  if (req.headers.authorization && req.headers.authorization.startsWith('Bearer')) {\r\n    token = req.headers.authorization.split(' ')[1];\r\n  }\r\n  // Check for token in cookies\r\n  else if (req.cookies?.token) {\r\n    token = req.cookies.token;\r\n  }\r\n\r\n  // Make sure token exists\r\n  if (!token) {\r\n    throw new Error('Not authorized to access this route');\r\n  }\r\n\r\n  try {\r\n    // Verify token\r\n    const decoded = jwt.verify(token, process.env.JWT_SECRET);\r\n\r\n    // Get user from token\r\n    const user = await User.findById(decoded.id).select('-password');\r\n\r\n    if (!user) {\r\n      throw new Error('User not found');\r\n    }\r\n\r\n    return user;\r\n  } catch (error) {\r\n    throw new Error('Invalid token');\r\n  }\r\n};\r\n\r\nexport const adminRequired = (user) => {\r\n  if (user.role !== 'admin') {\r\n    throw new Error('Admin access required');\r\n  }\r\n};"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,MAAM,eAAe,OAAO;IACjC,IAAI;IAEJ,0CAA0C;IAC1C,IAAI,IAAI,OAAO,CAAC,aAAa,IAAI,IAAI,OAAO,CAAC,aAAa,CAAC,UAAU,CAAC,WAAW;QAC/E,QAAQ,IAAI,OAAO,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;IACjD,OAEK,IAAI,IAAI,OAAO,EAAE,OAAO;QAC3B,QAAQ,IAAI,OAAO,CAAC,KAAK;IAC3B;IAEA,yBAAyB;IACzB,IAAI,CAAC,OAAO;QACV,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI;QACF,eAAe;QACf,MAAM,UAAU,2MAAG,CAAC,MAAM,CAAC,OAAO,QAAQ,GAAG,CAAC,UAAU;QAExD,sBAAsB;QACtB,MAAM,OAAO,MAAM,kIAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,EAAE,MAAM,CAAC;QAEpD,IAAI,CAAC,MAAM;YACT,MAAM,IAAI,MAAM;QAClB;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,MAAM,IAAI,MAAM;IAClB;AACF;AAEO,MAAM,gBAAgB,CAAC;IAC5B,IAAI,KAAK,IAAI,KAAK,SAAS;QACzB,MAAM,IAAI,MAAM;IAClB;AACF"}},
    {"offset": {"line": 408, "column": 0}, "map": {"version":3,"sources":["file:///D:/BEDegree/5th-Sem/CC/PetAdopt/app/api/pets/route.js"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport connectDB from '@/lib/config/db';\r\nimport Pet from '@/lib/models/Pet';\r\nimport { authRequired, adminRequired } from '@/lib/middleware/auth';\r\n\r\n// GET /api/pets - Get all available pets (Public)\r\nexport async function GET() {\r\n  try {\r\n    await connectDB();\r\n\r\n    // Only show available pets to public\r\n    const pets = await Pet.find({ status: 'available' })\r\n      .populate('shelterId', 'name address phone')\r\n      .sort({ createdAt: -1 });\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      count: pets.length,\r\n      data: pets\r\n    });\r\n  } catch (error) {\r\n    return NextResponse.json({\r\n      success: false,\r\n      message: error.message\r\n    }, { status: 500 });\r\n  }\r\n}\r\n\r\n// POST /api/pets - Create new pet (Admin only)\r\nexport async function POST(request) {\r\n  try {\r\n    await connectDB();\r\n\r\n    const user = await authRequired(request);\r\n    adminRequired(user);\r\n\r\n    const petData = await request.json();\r\n    const pet = await Pet.create(petData);\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      message: 'Pet added successfully',\r\n      data: pet\r\n    }, { status: 201 });\r\n  } catch (error) {\r\n    return NextResponse.json({\r\n      success: false,\r\n      message: error.message,\r\n      redirect: error.message.includes('Not authorized') ? '/signin' : undefined\r\n    }, {\r\n      status: error.message.includes('Admin access required') ? 403 :\r\n             error.message.includes('Not authorized') ? 401 : 500\r\n    });\r\n  }\r\n}"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;;;;;AAGO,eAAe;IACpB,IAAI;QACF,MAAM,IAAA,gIAAS;QAEf,qCAAqC;QACrC,MAAM,OAAO,MAAM,iIAAG,CAAC,IAAI,CAAC;YAAE,QAAQ;QAAY,GAC/C,QAAQ,CAAC,aAAa,sBACtB,IAAI,CAAC;YAAE,WAAW,CAAC;QAAE;QAExB,OAAO,+QAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,OAAO,KAAK,MAAM;YAClB,MAAM;QACR;IACF,EAAE,OAAO,OAAO;QACd,OAAO,+QAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS,MAAM,OAAO;QACxB,GAAG;YAAE,QAAQ;QAAI;IACnB;AACF;AAGO,eAAe,KAAK,OAAO;IAChC,IAAI;QACF,MAAM,IAAA,gIAAS;QAEf,MAAM,OAAO,MAAM,IAAA,2IAAY,EAAC;QAChC,IAAA,4IAAa,EAAC;QAEd,MAAM,UAAU,MAAM,QAAQ,IAAI;QAClC,MAAM,MAAM,MAAM,iIAAG,CAAC,MAAM,CAAC;QAE7B,OAAO,+QAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS;YACT,MAAM;QACR,GAAG;YAAE,QAAQ;QAAI;IACnB,EAAE,OAAO,OAAO;QACd,OAAO,+QAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS,MAAM,OAAO;YACtB,UAAU,MAAM,OAAO,CAAC,QAAQ,CAAC,oBAAoB,YAAY;QACnE,GAAG;YACD,QAAQ,MAAM,OAAO,CAAC,QAAQ,CAAC,2BAA2B,MACnD,MAAM,OAAO,CAAC,QAAQ,CAAC,oBAAoB,MAAM;QAC1D;IACF;AACF"}}]
}